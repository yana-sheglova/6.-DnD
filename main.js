!function(){"use strict";class e{constructor(e,t){this.text=e,this.columnId=t,this.cardElement=this.createCard(),this.bindEvents()}createCard(){const e=document.createElement("div");return e.classList.add("task"),e.setAttribute("draggable",!0),e.innerHTML=`\n            <span>${this.text}</span>\n            <button class="delete">✖</button>\n        `,e}bindEvents(){this.cardElement.addEventListener("dragstart",(e=>{e.dataTransfer.setData("text/plain",this.text),e.dataTransfer.effectAllowed="move",this.cardElement.classList.add("dragging")})),this.cardElement.addEventListener("dragend",(()=>{this.cardElement.classList.remove("dragging")})),this.cardElement.querySelector(".delete").addEventListener("click",(()=>{this.removeCard()}))}removeCard(){this.cardElement.remove(),this.removeFromLocalStorage(this.text)}removeFromLocalStorage(e){const t=(JSON.parse(localStorage.getItem("cards"))||[]).filter((t=>t.text!==e));localStorage.setItem("cards",JSON.stringify(t))}}class t{constructor(e){this.column=e,this.columnId=this.column.dataset.columnId,this.formElement=this.createForm(),this.column.appendChild(this.formElement),this.bindEvents()}createForm(){const e=document.createElement("div");return e.classList.add("form"),e.innerHTML='\n            <textarea class="task-text" rows="3" placeholder="Enter task text"></textarea>\n            <div class="button-container">\n                <button class="add">Add</button>\n                <button class="close">✖</button>\n            </div>\n        ',e}bindEvents(){this.formElement.querySelector(".add").addEventListener("click",(()=>{const t=this.formElement.querySelector(".task-text").value;if(t){const r=new e(t);this.column.insertBefore(r.cardElement,this.formElement),this.saveToLocalStorage(t,this.columnId),this.formElement.querySelector(".task-text").value=""}})),this.formElement.querySelector(".close").addEventListener("click",(()=>{this.column.removeChild(this.formElement),this.column.querySelector(".add-task").style.display="block"}))}saveToLocalStorage(e,t){const r=JSON.parse(localStorage.getItem("cards"))||[];r.push({text:e,columnId:t}),localStorage.setItem("cards",JSON.stringify(r))}}class r{constructor(){this.columns=document.querySelectorAll(".column"),this.init()}init(){this.columns.forEach((r=>{r.addEventListener("dragover",(e=>{e.preventDefault(),e.dataTransfer.dropEffect="move";const t=document.querySelector(".dragging"),n=this.getDragAfterElement(r,e.clientY);if(null==n){const e=r.querySelector(".add-task");r.insertBefore(t,e)}else r.insertBefore(t,n)})),r.addEventListener("drop",(t=>{t.preventDefault();const n=t.dataTransfer.getData("text/plain"),s=Array.from(this.columns).flatMap((e=>Array.from(e.querySelectorAll(".task")))).find((e=>e.querySelector("span").textContent===n));s&&s.remove();const a=new e(n,r.dataset.columnId);r.insertBefore(a.cardElement,r.querySelector(".add-task")),this.saveCardPosition(a)}));const n=r.querySelector(".add-task");n.addEventListener("click",(()=>{n.style.display="none",new t(r)})),this.loadCards(r)}))}loadCards(t){const r=t.dataset.columnId;(JSON.parse(localStorage.getItem("cards"))||[]).filter((e=>e.columnId===r)).forEach((r=>{const n=new e(r.text,r.columnId);t.insertBefore(n.cardElement,t.querySelector(".add-task"))}))}saveCardPosition(e){const t=JSON.parse(localStorage.getItem("cards"))||[],r=t.findIndex((t=>t.text===e.text));-1!==r?t[r].columnId=e.columnId:t.push({text:e.text,columnId:e.columnId}),localStorage.setItem("cards",JSON.stringify(t))}getDragAfterElement(e,t){[...e.querySelectorAll(".task:not(.dragging)")].reduce(((e,r)=>{const n=r.getBoundingClientRect(),s=t-n.top-n.height/2;return s<0&&(null===e||s>e.offset)?{offset:s,element:r}:e}),null)}}document.addEventListener("DOMContentLoaded",(()=>{new r}))}();
//# sourceMappingURL=main.js.map